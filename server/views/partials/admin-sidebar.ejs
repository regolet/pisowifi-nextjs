<!-- Mobile Header Bar -->
<div class="lg:hidden fixed top-0 left-0 right-0 z-50 bg-gray-100 border-b border-gray-300 px-4 py-3 flex items-center justify-between">
    <h1 class="text-lg font-semibold text-black">PISOWifi Admin</h1>
    <button id="mobile-menu-btn" onclick="toggleMobileMenu()" class="p-2 text-black hover:bg-gray-200 rounded-lg">
        <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
        <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
    </button>
</div>

<!-- Mobile Overlay -->
<div id="mobile-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40 hidden" onclick="toggleMobileMenu()"></div>

<!-- Compact Admin Sidebar -->
<div id="sidebar" class="w-52 bg-gray-100 border-r border-gray-300 flex flex-col h-screen fixed lg:relative z-50 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out">
    <div class="p-4 border-b border-gray-300 flex items-center justify-between">
        <h1 class="text-lg font-semibold text-black">PISOWifi Admin</h1>
        <button class="lg:hidden p-1 text-black hover:bg-gray-200 rounded" onclick="toggleMobileMenu()">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </button>
    </div>
    
    <nav class="flex-1 py-2 overflow-y-auto">
        <a href="/admin" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-200 <%= currentPage === 'dashboard' ? 'bg-gray-200 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                </svg>
            </span>
            Dashboard
        </a>
        <a href="/admin/clients" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'clients' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.89 1.97 1.74 1.97 2.95V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                </svg>
            </span>
            Clients
        </a>
        <a href="/admin/transactions" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'transactions' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                </svg>
            </span>
            Sales History
        </a>
        <a href="/admin/rates" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'rates' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M16 6l2.29 2.29-4.58 4.58-4-4L2 16.86V21h4.14L16 11.14l4.58 4.58L21 13v-7z"/>
                </svg>
            </span>
            Rates
        </a>
        <a href="/admin/network" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'network' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                </svg>
            </span>
            Network
        </a>
        <a href="/admin/gpio" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'gpio' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M17 16.5v-3h3v3h-3zM5 16.5v-3h3v3H5zm6-2h-1V8h1v6.5zM17 8v3h3V8h-3zM5 8v3h3V8H5zm6-2h-1V3h1v3zM7 5.5C7 4.12 8.12 3 9.5 3h5C15.88 3 17 4.12 17 5.5V21h-2v-4.5h-6V21H7V5.5z"/>
                </svg>
            </span>
            GPIO
        </a>
        <a href="/admin/coin-slots" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'coin-slots' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 1C5.925 1 1 5.925 1 12s4.925 11 11 11 11-4.925 11-11S18.075 1 12 1zm0 20c-4.962 0-9-4.038-9-9s4.038-9 9-9 9 4.038 9 9-4.038 9-9 9zm3.5-9c0 1.933-1.567 3.5-3.5 3.5S8.5 13.933 8.5 12 10.067 8.5 12 8.5s3.5 1.567 3.5 3.5z"/>
                </svg>
            </span>
            Coin Slots
        </a>
        <a href="/admin/portal-settings" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'portal-settings' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v2H8v2h8v-2h-2v-2h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 12H3V4h18v10z"/>
                </svg>
            </span>
            Portal Settings
        </a>
        <a href="/admin/settings" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'settings' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.62l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.48.1.62l2.03 1.58c-.05.3-.07.62-.07.94 0 .32.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.62l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .43-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.48-.1-.62l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                </svg>
            </span>
            Settings
        </a>
        <a href="/admin/reports" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'reports' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/>
                </svg>
            </span>
            Reports
        </a>
        <a href="/admin/device" onclick="closeMobileMenu()" class="flex items-center px-4 py-3 lg:py-2 text-sm text-black hover:bg-gray-100 <%= currentPage === 'device' ? 'bg-gray-100 border-r-2 border-blue-500' : '' %>">
            <span class="w-5 h-5 lg:w-4 lg:h-4 mr-3 flex-shrink-0">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M15.5 1h-8C6.12 1 5 2.12 5 3.5v17C5 21.88 6.12 23 7.5 23h8c1.38 0 2.5-1.12 2.5-2.5v-17C18 2.12 16.88 1 15.5 1zm-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4.5-4H7V4h9v14z"/>
                </svg>
            </span>
            Device
        </a>
    </nav>
    
    <div class="p-4 border-t border-gray-300">
        <div class="flex items-center justify-between">
            <div class="min-w-0 flex-1">
                <p class="text-xs font-medium text-black truncate"><%= typeof user !== 'undefined' ? user.username : 'Admin' %></p>
            </div>
            <form action="/admin/logout" method="POST" class="ml-2">
                <button type="submit" class="text-black hover:text-red-600 p-2 lg:p-1" title="Logout">
                    <svg class="w-5 h-5 lg:w-4 lg:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                    </svg>
                </button>
            </form>
        </div>
    </div>
</div>

<script>
    function toggleMobileMenu() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('mobile-overlay');
        const menuIcon = document.getElementById('menu-icon');
        const closeIcon = document.getElementById('close-icon');
        
        sidebar.classList.toggle('-translate-x-full');
        overlay.classList.toggle('hidden');
        menuIcon.classList.toggle('hidden');
        closeIcon.classList.toggle('hidden');
    }
    
    function closeMobileMenu() {
        if (window.innerWidth < 1024) {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            const menuIcon = document.getElementById('menu-icon');
            const closeIcon = document.getElementById('close-icon');
            
            sidebar.classList.add('-translate-x-full');
            overlay.classList.add('hidden');
            menuIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
        }
    }
</script>